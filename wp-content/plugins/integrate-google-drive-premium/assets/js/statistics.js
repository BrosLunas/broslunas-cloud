(()=>{"use strict";function e(e){var t=e.data,a=t.downloads.reduce((function(e,t){return e+parseInt(t.total)}),0),n=t.uploads.reduce((function(e,t){return e+parseInt(t.total)}),0),r=t.previews.reduce((function(e,t){return e+parseInt(t.total)}),0),l=t.streams.reduce((function(e,t){return e+parseInt(t.total)}),0),c=[{title:wp.i18n.__("Total Downloads","inegrate-google-drive"),value:a,key:"download"},{title:wp.i18n.__("Total Uploads","inegrate-google-drive"),value:n,key:"upload"},{title:wp.i18n.__("Total Previews","inegrate-google-drive"),value:r,key:"preview"},{title:wp.i18n.__("Total Streams","inegrate-google-drive"),value:l,key:"stream"}];return React.createElement("div",{className:"statistics-summary"},c.map((function(e){var t=e.title,a=e.value,n=e.key;return React.createElement("div",{key:n,className:"statistics-summary-item summary-".concat(n)},React.createElement("img",{src:"".concat(igd.pluginUrl,"/assets/images/statistics/").concat(n,".svg"),alt:t,className:"statistics-summary-item-icon"}),React.createElement("div",{className:"summary-info"},React.createElement("span",{className:"statistics-summary-item-count"},a),React.createElement("span",{className:"statistics-summary-item-title"},t)))})))}function t(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={text:{"application/vnd.oasis.opendocument.text":"Text","text/plain":"Text"},file:{"text/html":"HTML","text/php":"PHP","x-httpd-php":"PHP","text/css":"CSS","text/js":"JavaScript","application/javascript":"JavaScript","application/json":"JSON","application/xml":"XML","application/x-shockwave-flash":"SWF","video/x-flv":"FLV","application/vnd.google-apps.file":"File"},image:{"application/vnd.google-apps.photo":"Photo","image/png":"PNG","image/jpeg":"JPEG","image/jpg":"JPG","image/gif":"GIF","image/bmp":"BMP","image/vnd.microsoft.icon":"ICO","image/tiff":"TIFF","image/tif":"TIF","image/svg+xml":"SVG"},zip:{"application/zip":"ZIP","application/x-rar-compressed":"RAR","application/x-msdownload":"EXE","application/vnd.ms-cab-compressed":"CAB"},audio:{"audio/mpeg":"MP3","video/quicktime":"QT","application/vnd.google-apps.audio":"Audio","audio/x-m4a":"Audio"},video:{"application/vnd.google-apps.video":"Video","video/x-flv":"Video","video/mp4":"Video","video/webm":"Video","video/ogg":"Video","application/x-mpegURL":"Video","video/MP2T":"Video","video/3gpp":"Video","video/quicktime":"Video","video/x-msvideo":"Video","video/x-ms-wmv":"Video"},pdf:{"application/pdf":"PDF"},word:{"application/msword":"MS Word"},doc:{"application/vnd.google-apps.document":"Google Docs"},excel:{"application/vnd.ms-excel":"Excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"Excel"},presentation:{"application/vnd.google-apps.presentation":"Slide","application/vnd.oasis.opendocument.presentation":"Presentation"},powerpoint:{"application/vnd.ms-powerpoint":"Powerpoint"},form:{"application/vnd.google-apps.form":"Form"},folder:{"application/vnd.google-apps.folder":"Folder"},drawing:{"application/vnd.google-apps.drawing":"Drawing"},script:{"application/vnd.google-apps.script":"Script"},sites:{"application/vnd.google-apps.sites":"Sites"},spreadsheet:{"application/vnd.google-apps.spreadsheet":"Spreadsheet","application/vnd.oasis.opendocument.spreadsheet":"Spreadsheet"}},n="File",r="file";return Object.keys(a).map((function(l){t&&a[l][e]?r=l:a[l][e]&&(n=a[l][e])})),t?r:n}(e,!0);return t=t||"file","".concat(igd.pluginUrl,"/assets/images/icons/").concat(t,".png")}function a(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=(e=new Date(e)).getFullYear(),n=("0"+(e.getMonth()+1)).slice(-2),r=("0"+e.getDate()).slice(-2);if(t){var l=e.getHours(),c=l<12?"AM":"PM",o=0===l?12:l>12?l-12:l,i=("0"+e.getMinutes()).slice(-2);return"".concat(a,"-").concat(n,"-").concat(r," ").concat(("0"+o).slice(-2),":").concat(i," ").concat(c)}return"".concat(a,"-").concat(n,"-").concat(r)}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t,a){var r;return r=function(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==n(r)?r:String(r))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,o=[],i=!0,s=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;i=!1}else for(;!(i=(n=l.call(a)).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{if(!i&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(s)throw r}}return o}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return d(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var u=React,m=u.useState,p=u.useEffect,g=u.useRef;function f(e){var t=e.data,n=i(m(!localStorage.getItem("igd_show_chart_data")||"true"==localStorage.getItem("igd_show_chart_data")),2),l=n[0],o=n[1],s=g(null),d=t.events.map((function(e){return c(c({},e),{},{created_at:a(e.created_at)})})),u=r(new Set(d.map((function(e){return e.created_at})))).reverse(),f=_.groupBy(d.filter((function(e){return"download"===e.type})),(function(e){return e.created_at})),v=_.groupBy(d.filter((function(e){return"upload"===e.type})),(function(e){return e.created_at})),h=_.groupBy(d.filter((function(e){return"preview"===e.type})),(function(e){return e.created_at})),E=_.groupBy(d.filter((function(e){return"stream"===e.type})),(function(e){return e.created_at})),w=u.map((function(e){return f[e]?f[e].length:0})),R=u.map((function(e){return v[e]?v[e].length:0})),y=u.map((function(e){return h[e]?h[e].length:0})),b=u.map((function(e){return E[e]?E[e].length:0}));return p((function(){var e=document.createElement("canvas");l||(e.style.display="none"),e.height=400,s.current.appendChild(e);var t=new Chart(e,{type:"line",data:{labels:u.map((function(e){return a(e)})),datasets:[{label:"Downloads",data:w,backgroundColor:"rgba(47, 180, 75, 0.1)",borderColor:"#2FB44B",borderWidth:2},{label:"Uploads",data:R,backgroundColor:"rgba(112, 197, 255, 0.1)",borderColor:"#70C5FF",borderWidth:2},{label:"Previews",data:y,backgroundColor:"rgba(252, 163, 29, 0.1)",borderColor:"#18B3FD",borderWidth:2},{label:"Streams",data:b,backgroundColor:"rgba(125, 162, 246, 0.1)",borderColor:"#7DA2F6",borderWidth:2}]},options:{responsive:!1}});return function(){e.remove(),t.destroy()}}),[d]),React.createElement("div",{className:"statistics-box event-chart",ref:s},React.createElement("span",{className:"box-title"},wp.i18n.__("Events Chart / Day","integrate-google-drive"),React.createElement("i",{className:"dashicons dashicons-arrow-".concat(l?"up":"down","-alt2"),onClick:function(){localStorage.setItem("igd_show_chart_data",!l),o(!l)}})))}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,o=[],i=!0,s=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;i=!1}else for(;!(i=(n=l.call(a)).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{if(!i&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var E=React.useState;function w(e){var a=e.data,n=v(E(!localStorage.getItem("igd_show_downloads_data")||"true"==localStorage.getItem("igd_show_downloads_data")),2),r=n[0],l=n[1],c=v(E(!localStorage.getItem("igd_show_downloads_users")||"true"==localStorage.getItem("igd_show_downloads_users")),2),o=c[0],i=c[1],s=a.downloads,d=a.downloadUsers;return React.createElement("div",{className:"statistics-boxes top-download"},React.createElement("div",{className:"statistics-box"},React.createElement("span",{className:"box-title"},wp.i18n.__("Top Downloads","integrate-google-drive"),React.createElement("i",{className:"dashicons dashicons-arrow-".concat(r?"up":"down","-alt2"),onClick:function(){localStorage.setItem("igd_show_downloads_data",!r),l(!r)}})),React.createElement("div",{className:"table-wrapper ".concat(r?"":"igd-hidden")},s.length>0?React.createElement("table",{className:"widefat top-items striped"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null),React.createElement("th",null,wp.i18n.__("File","integrate-google-drive")),React.createElement("th",null,wp.i18n.__("Total","integrate-google-drive")))),React.createElement("tbody",null,s.map((function(e,a){return React.createElement("tr",{key:a},React.createElement("td",null,React.createElement("div",{className:"sl"},React.createElement("span",{className:"sl-no"},a+1,"."),React.createElement("img",{width:24,src:t(e.file_type)}))),React.createElement("td",null,React.createElement("a",{href:"https://drive.google.com/file/d/".concat(e.file_id,"/view?usp=drivesdk"),target:"_blank"},e.file_name)),React.createElement("td",null,e.total))})))):React.createElement("span",{className:"no-data"},wp.i18n.__("No data found","integrate-google-drive")))),React.createElement("div",{className:"statistics-box"},React.createElement("span",{className:"box-title"},wp.i18n.__("Top Users with most Downloads","integrate-google-drive"),React.createElement("i",{className:"dashicons dashicons-arrow-".concat(o?"up":"down","-alt2"),onClick:function(){localStorage.setItem("igd_show_downloads_users",!o),i(!o)}})),React.createElement("div",{className:"table-wrapper ".concat(o?"":"igd-hidden")},d.length?React.createElement("table",{className:"widefat top-users striped"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null),React.createElement("th",null,wp.i18n.__("User","integrate-google-drive")),React.createElement("th",null,wp.i18n.__("Total","integrate-google-drive")))),React.createElement("tbody",null,d.map((function(e,t){return React.createElement("tr",{key:t},React.createElement("td",null,React.createElement("div",{className:"sl"},React.createElement("span",{className:"sl-no"},t+1,"."),React.createElement("span",{dangerouslySetInnerHTML:{__html:e.avatar}}))),React.createElement("td",null,parseInt(e.user_id)?React.createElement("a",{href:"".concat(igd.adminUrl,"/user-edit.php?user_id=").concat(e.user_id),target:"_blank"},e.name):e.name),React.createElement("td",null,e.count))})))):React.createElement("span",{className:"no-data"},wp.i18n.__("No data found","integrate-google-drive")))))}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,o=[],i=!0,s=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;i=!1}else for(;!(i=(n=l.call(a)).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{if(!i&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var b=React.useState;function N(e){var n=e.data,r=n.uploads,l=n.uploadUsers,c=R(b(!localStorage.getItem("igd_show_uploads_data")||"true"==localStorage.getItem("igd_show_uploads_data")),2),o=c[0],i=c[1],s=R(b(!localStorage.getItem("igd_show_uploads_users")||"true"==localStorage.getItem("igd_show_uploads_users")),2),d=s[0],u=s[1];return React.createElement("div",{className:"statistics-boxes top-upload"},React.createElement("div",{className:"statistics-box"},React.createElement("span",{className:"box-title"},wp.i18n.__("Top Uploads","integrate-google-drive"),React.createElement("i",{className:"dashicons dashicons-arrow-".concat(o?"up":"down","-alt2"),onClick:function(){localStorage.setItem("igd_show_uploads_data",!o),i(!o)}})),React.createElement("div",{className:"table-wrapper ".concat(o?"":"igd-hidden")},r.length>0?React.createElement("table",{className:"widefat top-items striped"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null),React.createElement("th",null,wp.i18n.__("File","integrate-google-drive")),React.createElement("th",null,wp.i18n.__("Date","integrate-google-drive")))),React.createElement("tbody",null,r.map((function(e,n){return React.createElement("tr",{key:n},React.createElement("td",null,React.createElement("div",{className:"sl"},React.createElement("span",{className:"sl-no"},n+1,"."),React.createElement("img",{width:24,src:t(e.file_type)}))),React.createElement("td",{width:"55%"},React.createElement("a",{href:"https://drive.google.com/file/d/".concat(e.file_id,"/view?usp=drivesdk"),target:"_blank"},e.file_name)),React.createElement("td",{className:"col-date"},function(e){var t=new Date,n=Math.abs(t-new Date(e)),r=Math.floor(n/864e5);if(r>7)return a(e);var l=Math.floor(n/36e5),c=Math.floor(n/6e4);return r>0?r+" day"+(r>1?"s":"")+" ago":l>0?l+" hour"+(l>1?"s":"")+" ago":c+" minute"+(c>1?"s":"")+" ago"}(e.created_at)))})))):React.createElement("span",{className:"no-data"},wp.i18n.__("No data found!","integrate-google-drive")))),React.createElement("div",{className:"statistics-box"},React.createElement("span",{className:"box-title"},wp.i18n.__("Top Users with most Uploads","integrate-google-drive"),React.createElement("i",{className:"dashicons dashicons-arrow-".concat(d?"up":"down","-alt2"),onClick:function(){localStorage.setItem("igd_show_uploads_users",!d),u(!d)}})),React.createElement("div",{className:"table-wrapper ".concat(d?"":"igd-hidden")},l.length>0?React.createElement("table",{className:"widefat top-users striped"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null),React.createElement("th",null,wp.i18n.__("User","integrate-google-drive")),React.createElement("th",null,wp.i18n.__("Uploads","integrate-google-drive")))),React.createElement("tbody",null,l.map((function(e,t){return React.createElement("tr",{key:t},React.createElement("td",null,React.createElement("div",{className:"sl"},React.createElement("span",{className:"sl-no"},t+1,"."),React.createElement("span",{dangerouslySetInnerHTML:{__html:e.avatar}}))),React.createElement("td",null,parseInt(e.user_id)?React.createElement("a",{href:"".concat(igd.adminUrl,"/user-edit.php?user_id=").concat(e.user_id),target:"_blank"},e.name):e.name),React.createElement("td",null,e.count))})))):React.createElement("span",{className:"no-data"},wp.i18n.__("No data found!","integrate-google-drive")))))}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,o=[],i=!0,s=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;i=!1}else for(;!(i=(n=l.call(a)).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{if(!i&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var I=React.useState;function j(e){var a=e.data,n=a.streams,r=a.streamUsers,l=S(I(!localStorage.getItem("igd_show_streams_data")||"true"==localStorage.getItem("igd_show_streams_data")),2),c=l[0],o=l[1],i=S(I(!localStorage.getItem("igd_show_streams_users")||"true"==localStorage.getItem("igd_show_streams_users")),2),s=i[0],d=i[1];return React.createElement("div",{className:"statistics-boxes top-stream"},React.createElement("div",{className:"statistics-box"},React.createElement("span",{className:"box-title"},wp.i18n.__("Top Streams","integrate-google-drive"),React.createElement("i",{className:"dashicons dashicons-arrow-".concat(c?"up":"down","-alt2"),onClick:function(){localStorage.setItem("igd_show_streams_data",!c),o(!c)}})),React.createElement("div",{className:"table-wrapper ".concat(c?"":"igd-hidden")},n.length>0?React.createElement("table",{className:"widefat top-items striped"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null),React.createElement("th",null,wp.i18n.__("File","integrate-google-drive")),React.createElement("th",null,wp.i18n.__("Total","integrate-google-drive")))),React.createElement("tbody",null,n.map((function(e,a){return React.createElement("tr",{key:a},React.createElement("td",null,React.createElement("div",{className:"sl"},React.createElement("span",{className:"sl-no"},a+1,"."),React.createElement("img",{width:24,src:t(e.file_type)}))),React.createElement("td",null,React.createElement("a",{href:"https://drive.google.com/file/d/".concat(e.file_id,"/view?usp=drivesdk"),target:"_blank"},e.file_name)),React.createElement("td",null,e.total))})))):React.createElement("span",{className:"no-data"},wp.i18n.__("No data found","integrate-google-drive")))),React.createElement("div",{className:"statistics-box"},React.createElement("span",{className:"box-title"},wp.i18n.__("Top Users with most Streams","integrate-google-drive"),React.createElement("i",{className:"dashicons dashicons-arrow-".concat(s?"up":"down","-alt2"),onClick:function(){localStorage.setItem("igd_show_streams_users",!s),d(!s)}})),React.createElement("div",{className:"table-wrapper ".concat(s?"":"igd-hidden")},r.length>0?React.createElement("table",{className:"widefat top-users striped"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null),React.createElement("th",null,wp.i18n.__("User","integrate-google-drive")),React.createElement("th",null,wp.i18n.__("Total","integrate-google-drive")))),React.createElement("tbody",null,r.map((function(e,t){return React.createElement("tr",{key:t},React.createElement("td",null,React.createElement("div",{className:"sl"},React.createElement("span",{className:"sl-no"},t+1,"."),React.createElement("span",{dangerouslySetInnerHTML:{__html:e.avatar}}))),React.createElement("td",null,parseInt(e.user_id)?React.createElement("a",{href:"".concat(igd.adminUrl,"/user-edit.php?user_id=").concat(e.user_id),target:"_blank"},e.name):e.name),React.createElement("td",null,e.count))})))):React.createElement("span",{className:"no-data"},wp.i18n.__("No data found","integrate-google-drive")))))}function A(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,o=[],i=!0,s=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;i=!1}else for(;!(i=(n=l.call(a)).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{if(!i&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(s)throw r}}return o}}(e,t)||O(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){if(e){if("string"==typeof e)return T(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?T(e,t):void 0}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var C=React,D=C.useState,U=C.useEffect,P=C.useRef;function M(e){var t=e.data,n=e.startDate,r=e.endDate,l=k(D(t.events),2),c=l[0],o=l[1],i=localStorage.getItem("igd_show_logs_data"),s=k(D(!i||"true"===i),2),d=s[0],u=s[1],m=k(D(c.length>=30?2:0),2),p=m[0],g=m[1],f=k(D(!1),2),v=f[0],h=f[1],_=P();return U((function(){if(!(p<1||v)){var e=function(){var e=_.current;e.scrollTop+e.clientHeight>=e.scrollHeight-1&&(h(!0),wp.ajax.send("igd_get_events",{data:{page:p,start_date:n,end_date:r,nonce:igd.nonce},success:function(e){g((function(t){return e.complete?0:t+1})),o((function(t){return[].concat(A(t),A(e.events))}))},error:function(e){console.log(e),g(0)},complete:function(){h(!1)}}))},t=_.current;return t&&t.addEventListener("scroll",e),function(){t&&t.removeEventListener("scroll",e)}}}),[p,v]),React.createElement("div",{className:"statistics-box event-logs"},React.createElement("span",{className:"box-title"},wp.i18n.__("All Event Logs","integrate-google-drive"),React.createElement("i",{className:"dashicons dashicons-arrow-".concat(d?"up":"down","-alt2"),onClick:function(){localStorage.setItem("igd_show_logs_data",!d),u(!d)}})),React.createElement("div",{ref:_,className:"table-wrapper ".concat(d?"":"igd-hidden")},c.length>0?React.createElement(React.Fragment,null,React.createElement("table",{className:"widefat striped"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null),React.createElement("th",null,React.createElement("div",null,wp.i18n.__("Description","integrate-google-drive"))),React.createElement("th",null,React.createElement("div",null,wp.i18n.__("Date","integrate-google-drive"))))),React.createElement("tbody",null,c.map((function(e,t){var n=e.file_id,r=e.file_name,l=e.user_id,c=e.username,o=e.type,i=e.created_at,s=React.createElement("img",{src:"".concat(igd.pluginUrl,"/assets/images/statistics/").concat(o,".svg"),alt:o}),d=parseInt(l)?React.createElement("a",{href:"".concat(igd.adminUrl,"/user-edit.php?user_id=").concat(l),target:"_blank"},c):wp.i18n.__("A visitor","integrate-google-drive"),u=React.createElement("a",{href:"https://drive.google.com/file/d/".concat(n,"/view?usp=drivesdk"),target:"_blank"},r);"search"===o&&(u=n);var m={download:wp.i18n.__("downloaded the file","integrate-google-drive"),upload:wp.i18n.__("uploaded the file","integrate-google-drive"),stream:wp.i18n.__("streamed the file","integrate-google-drive"),delete:wp.i18n.__("deleted the file","integrate-google-drive"),copy:wp.i18n.__("copied the file","integrate-google-drive"),move:wp.i18n.__("moved the file","integrate-google-drive"),rename:wp.i18n.__("renamed the file","integrate-google-drive"),create:wp.i18n.__("created the file","integrate-google-drive"),share:wp.i18n.__("shared the file","integrate-google-drive"),description:wp.i18n.__("updated description of the file","integrate-google-drive"),search:wp.i18n.__("searched for","integrate-google-drive"),folder:wp.i18n.__("created a new folder","integrate-google-drive")}[o]||wp.i18n.__("previewed the file","integrate-google-drive");return React.createElement("tr",{key:t},React.createElement("td",null,React.createElement("div",{className:"sl"},React.createElement("span",{className:"sl-no"},t+1,".")," ",s)),React.createElement("td",null,d," ",m," ",u),React.createElement("td",{className:"col-date"},a(i,!0)))})))),v&&React.createElement("div",{className:"igd-spinner spinner-large"})):React.createElement("div",{className:"no-data"},wp.i18n.__("No data found!","integrate-google-drive"))))}var F=React.useEffect;function B(e){var t=e.startDate,a=e.endDate,n=e.setStartDate,r=e.setEndDate,l=e.setData;return F((function(){var e=jQuery;e(".igd-date-field").each((function(){var n=e(this).hasClass("end-date")?a:t;e(this).datepicker({defaultDate:n,dateFormat:"yy-mm-dd",nextText:"",prevText:"",beforeShow:function(t,a){e(a.dpDiv).addClass("igd-datepicker")}})}))}),[]),React.createElement("div",{className:"statistics-header"},React.createElement("div",{className:"statistics-header-title"},React.createElement("img",{src:igd.pluginUrl+"/assets/images/statistics/statistics-icon.svg",alt:"Statistics"}),React.createElement("span",null,wp.i18n.__("Statistics","integrate-google-drive"))),React.createElement("div",{className:"statistics-range"},React.createElement("div",{className:"date-field-wrap"},React.createElement("label",{className:"date-field-prefix",htmlFor:"start-date"},React.createElement("i",{className:"dashicons dashicons-calendar-alt"}),React.createElement("span",null,wp.i18n.__("From","integrate-google-drive"))),React.createElement("input",{type:"text",id:"start-date",className:"igd-date-field start-date",value:t,onChange:function(e){return n(e.target.value)}}),React.createElement("label",{className:"date-field-suffix",htmlFor:"start-date"},React.createElement("i",{className:"dashicons dashicons-arrow-down"}))),React.createElement("div",{className:"date-field-wrap"},React.createElement("label",{className:"date-field-prefix",htmlFor:"end-date"},React.createElement("i",{className:"dashicons dashicons-calendar-alt"}),React.createElement("span",null,wp.i18n.__("To","integrate-google-drive"))),React.createElement("input",{type:"text",id:"end-date",className:"igd-date-field end-date",value:a,onChange:function(e){return r(e.target.value)}}),React.createElement("label",{className:"date-field-suffix",htmlFor:"end-date"},React.createElement("i",{className:"dashicons dashicons-arrow-down"}))),React.createElement("button",{type:"button",className:"igd-btn btn-primary",onClick:function(){var e=document.querySelector(".start-date").value,t=document.querySelector(".end-date").value;n(e),r(t)}},React.createElement("i",{className:"dashicons dashicons-filter"}),React.createElement("span",null,wp.i18n.__("Filter","integrate-google-drive"))),React.createElement("i",{"data-tip":"","data-for":"clear-statistics",className:"clear-statistics dashicons dashicons-ellipsis"}),React.createElement(ReactTooltip,{id:"clear-statistics",place:"left",type:"light",effect:"solid",event:"click",globalEventOff:"click",className:"igd-tooltip clear-statistics-tooltip",clickable:!0,border:!0,borderColor:"#DDD"},React.createElement("button",{className:"igd-btn btn-info",onClick:function(){wp.ajax.post("igd_export_statistics",{start_date:t,end_date:a,nonce:igd.nonce}).done((function(e){console.log(e),e.success?window.location.href=e.url:Swal.fire({title:wp.i18n.__("Error!","integrate-google-drive"),text:wp.i18n.__("Something went wrong.","integrate-google-drive"),icon:"error",toast:!0,timer:2e3,timerProgressBar:!0,showConfirmButton:!1})}))}},React.createElement("i",{className:"dashicons dashicons-download"}),wp.i18n.__("Export Statistics","integrate-google-drive")),React.createElement("button",{type:"button",className:"igd-btn btn-danger",onClick:function(){Swal.fire({title:wp.i18n.__("Deleted!","integrate-google-drive"),text:wp.i18n.__("All statistics data has been deleted.","integrate-google-drive"),icon:"success",toast:!0,timer:2e3,timerProgressBar:!0,showConfirmButton:!1}),l({downloads:[],downloadUsers:[],uploads:[],uploadUsers:[],streams:[],streamUsers:[],previews:[],previewUsers:[],searches:[],searchUsers:[],events:[]}),wp.ajax.post("igd_clear_statistics",{nonce:igd.nonce})}},React.createElement("i",{className:"dashicons dashicons-trash"}),wp.i18n.__("Clear Statistics","integrate-google-drive")))))}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,o=[],i=!0,s=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;i=!1}else for(;!(i=(n=l.call(a)).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{if(!i&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var H=React.useState;function $(e){var a=e.data,n=V(H(!localStorage.getItem("igd_show_previews_data")||"true"==localStorage.getItem("igd_show_previews_data")),2),r=n[0],l=n[1],c=V(H(!localStorage.getItem("igd_show_previews_users")||"true"==localStorage.getItem("igd_show_previews_users")),2),o=c[0],i=c[1],s=a.previews,d=a.previewUsers;return React.createElement("div",{className:"statistics-boxes top-preview"},React.createElement("div",{className:"statistics-box"},React.createElement("span",{className:"box-title"},wp.i18n.__("Top Previews","integrate-google-drive"),React.createElement("i",{className:"dashicons dashicons-arrow-".concat(r?"up":"down","-alt2"),onClick:function(){localStorage.setItem("igd_show_previews_data",!r),l(!r)}})),React.createElement("div",{className:"table-wrapper ".concat(r?"":"igd-hidden")},s.length>0?React.createElement("table",{className:"widefat top-items striped"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null),React.createElement("th",null,wp.i18n.__("File","integrate-google-drive")),React.createElement("th",null,wp.i18n.__("Total","integrate-google-drive")))),React.createElement("tbody",null,s.map((function(e,a){return React.createElement("tr",{key:a},React.createElement("td",null,React.createElement("div",{className:"sl"},React.createElement("span",{className:"sl-no"},a+1,".")," ",React.createElement("img",{width:24,src:t(e.file_type)}))),React.createElement("td",null,React.createElement("a",{href:"https://drive.google.com/file/d/".concat(e.file_id,"/view?usp=drivesdk"),target:"_blank"},e.file_name)),React.createElement("td",null,e.total))})))):React.createElement("span",{className:"no-data"},wp.i18n.__("No data found","integrate-google-drive")))),React.createElement("div",{className:"statistics-box"},React.createElement("span",{className:"box-title"},wp.i18n.__("Top Users with most Previews","integrate-google-drive"),React.createElement("i",{className:"dashicons dashicons-arrow-".concat(o?"up":"down","-alt2"),onClick:function(){localStorage.setItem("igd_show_previews_users",!o),i(!o)}})),React.createElement("div",{className:"table-wrapper ".concat(o?"":"igd-hidden")},d.length?React.createElement("table",{className:"widefat top-users striped"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null),React.createElement("th",null,wp.i18n.__("User","integrate-google-drive")),React.createElement("th",null,wp.i18n.__("Total","integrate-google-drive")))),React.createElement("tbody",null,d.map((function(e,t){return React.createElement("tr",{key:t},React.createElement("td",null,React.createElement("div",{className:"sl"},React.createElement("span",{className:"sl-no"},t+1,"."),React.createElement("span",{dangerouslySetInnerHTML:{__html:e.avatar}}))),React.createElement("td",null,parseInt(e.user_id)?React.createElement("a",{href:"".concat(igd.adminUrl,"/user-edit.php?user_id=").concat(e.user_id),target:"_blank"},e.name):e.name),React.createElement("td",null,e.count))})))):React.createElement("span",{className:"no-data"},wp.i18n.__("No data found","integrate-google-drive")))))}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,o=[],i=!0,s=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;i=!1}else for(;!(i=(n=l.call(a)).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{if(!i&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return W(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return W(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var q=React.useState;function J(e){var t=e.data,a=localStorage.getItem("igd_show_searches_data"),n=localStorage.getItem("igd_show_searches_users"),r=G(q(!a||"true"===a),2),l=r[0],c=r[1],o=G(q(!n||"true"===n),2),i=o[0],s=o[1],d=t.searches,u=void 0===d?[]:d,m=t.searchUsers;return React.createElement("div",{className:"statistics-boxes top-search"},React.createElement("div",{className:"statistics-box"},React.createElement("span",{className:"box-title"},wp.i18n.__("Top Searches","integrate-google-drive"),React.createElement("i",{className:"dashicons dashicons-arrow-".concat(l?"up":"down","-alt2"),onClick:function(){localStorage.setItem("igd_show_searches_data",!l),c(!l)}})),React.createElement("div",{className:"table-wrapper ".concat(l?"":"igd-hidden")},u.length>0?React.createElement("table",{className:"widefat top-items striped"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null),React.createElement("th",null,wp.i18n.__("Query","integrate-google-drive")),React.createElement("th",null,wp.i18n.__("Total","integrate-google-drive")))),React.createElement("tbody",null,u.map((function(e,t){var a=e.file_id,n=e.total;return React.createElement("tr",{key:t},React.createElement("td",null,React.createElement("div",{className:"sl"},React.createElement("span",{className:"sl-no"},t+1,"."))),React.createElement("td",null,a),React.createElement("td",null,n))})))):React.createElement("span",{className:"no-data"},wp.i18n.__("No data found","integrate-google-drive")))),React.createElement("div",{className:"statistics-box"},React.createElement("span",{className:"box-title"},wp.i18n.__("Top Users with most Searches","integrate-google-drive"),React.createElement("i",{className:"dashicons dashicons-arrow-".concat(i?"up":"down","-alt2"),onClick:function(){localStorage.setItem("igd_show_searches_users",!i),s(!i)}})),React.createElement("div",{className:"table-wrapper ".concat(i?"":"igd-hidden")},m.length?React.createElement("table",{className:"widefat top-users striped"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null),React.createElement("th",null,wp.i18n.__("User","integrate-google-drive")),React.createElement("th",null,wp.i18n.__("Total","integrate-google-drive")))),React.createElement("tbody",null,m.map((function(e,t){var a=e.user_id,n=e.name,r=e.avatar,l=e.count;return React.createElement("tr",{key:t},React.createElement("td",null,React.createElement("div",{className:"sl"},React.createElement("span",{className:"sl-no"},t+1,"."),React.createElement("span",{dangerouslySetInnerHTML:{__html:r}}))),React.createElement("td",null,parseInt(a)?React.createElement("a",{href:"".concat(igd.adminUrl,"/user-edit.php?user_id=").concat(a),target:"_blank"},n):n),React.createElement("td",null,l))})))):React.createElement("span",{className:"no-data"},wp.i18n.__("No data found","integrate-google-drive")))))}function Q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,o=[],i=!0,s=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;i=!1}else for(;!(i=(n=l.call(a)).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{if(!i&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var K=React,X=K.useState,Y=K.useEffect;function Z(){var t=Q(X(!1),2),n=t[0],r=t[1],l=new Date;l.setMonth(l.getMonth()-1);var c=Q(X(a(l)),2),o=c[0],i=c[1],s=Q(X(a(new Date)),2),d=s[0],u=s[1],m=Q(X(null),2),p=m[0],g=m[1];function v(e){var t=new Date(e),a=t.getFullYear(),n=("0"+(t.getMonth()+1)).slice(-2),r=("0"+t.getDate()).slice(-2);return"".concat(a,"-").concat(n,"-").concat(r)}return Y((function(){r(!0),g(null),wp.ajax.send("igd_get_logs",{data:{start_date:v(o),end_date:v(d),nonce:igd.nonce},success:function(e){g(e)},error:function(e){console.log(e)},complete:function(){r(!1)}})}),[o,d]),Y((function(){igd.isPro||Swal.fire({title:wp.i18n.__("Upgrade to Pro","integrate-google-drive"),text:wp.i18n.__("Upgrade to Pro to access the statistics.","integrate-google-drive"),icon:"warning",confirmButtonText:wp.i18n.__("GET PRO","integrate-google-drive"),target:document.querySelector(".private-folders-table-wrap"),heightAuto:!1,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,customClass:{container:"igd-swal"}})}),[]),React.createElement("div",{className:"igd-statistics-wrapper"},React.createElement(B,{startDate:o,endDate:d,setStartDate:i,setEndDate:u,setData:g}),n&&React.createElement("div",{className:"igd-spinner spinner-large"}),!!p&&React.createElement(e,{data:p}),!!p&&React.createElement("div",{className:"statistics-boxes-wrapper"},React.createElement(f,{data:p}),React.createElement(w,{data:p}),React.createElement(N,{data:p}),React.createElement($,{data:p}),React.createElement(j,{data:p}),React.createElement(J,{data:p}),React.createElement(M,{data:p,startDate:o,endDate:d})))}var ee=document.getElementById("igd-statistics");ee&&ReactDOM.render(React.createElement(Z,null),ee)})();