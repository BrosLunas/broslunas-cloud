(()=>{"use strict";function e(e){var t;return!e||!e.type||("application/vnd.google-apps.folder"===e.type||"application/vnd.google-apps.folder"===(null===(t=e.shortcutDetails)||void 0===t?void 0:t.targetMimeType))}function t(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e.id,o=e.iconLink,r=e.thumbnailLink;e.accountId;e.shortcutDetails&&(n=e.shortcutDetails.targetId);var l=i.w,c=i.h;l||(l=64),c||(c=64);var d=null==o?void 0:o.replace("/16/","/".concat(l,"/"));return r&&(d=function(e){var t,i;return"reader"===(null===(t=e.permissions)||void 0===t||null===(t=t.users)||void 0===t||null===(t=t.anyoneWithLink)||void 0===t?void 0:t.role)||"writer"===(null===(i=e.permissions)||void 0===i||null===(i=i.users)||void 0===i||null===(i=i.anyoneWithLink)||void 0===i?void 0:i.role)}(e)?"custom"===t?"https://drive.google.com/thumbnail?id=".concat(n,"&sz=w").concat(l,"-h").concat(c):"https://drive.google.com/thumbnail?id=".concat(n,"small"===t?"&sz=w300-h300":"medium"===t?"&sz=w600-h400":"large"===t?"&sz=w1024-h768":"full"===t?"&sz=w2048":"&sz=w300-h300"):r.includes("google.com")?"custom"===t?r.replace("=s220","=w".concat(l,"-h").concat(c)):"small"===t?r.replace("=s220","=w300-h300"):"medium"===t?r.replace("=s220","=h600-nu"):"large"===t?r.replace("=s220","=w1024-h768-p-k-nu"):"full"===t?r.replace("=s220",""):r.replace("=s220","=w200-h190-p-k-nu"):function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300,o={id:e.id,accountId:e.accountId,size:t};"custom"===t&&(o.w=i,o.h=n);var r=a(JSON.stringify(o));return"".concat(igd.homeUrl,"?igd_preview_image=").concat(r)}(e,t,l,c)),d}var i,n,o;function a(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))}function r(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}i=jQuery,n=window.ModuleBuilderModal,o={init:function(){i(document).on("click",".igd-acf-button",(function(e){var t=i(this);Swal.fire({html:'<div id="igd-select-files" class="igd-module-builder-modal-wrap"></div>',showConfirmButton:!1,customClass:{container:"igd-swal igd-module-builder-modal-container"},didOpen:function(e){ReactDOM.render(React.createElement(n,{initData:{},onUpdate:function(e){o.addFiles(t,e),Swal.close()},onClose:function(){return Swal.close()},isSelectFiles:!0}),document.getElementById("igd-select-files"))},willClose:function(e){ReactDOM.unmountComponentAtNode(document.getElementById("igd-select-files"))}})})),i(document).on("click",".igd-acf-field .file-remove",(function(e){e.preventDefault();var t=i(this).data("id"),n=i(this).closest(".igd-acf-field"),o=JSON.parse(i("input",n).val()).filter((function(e){return e.id!==t}));i("input",n).val(JSON.stringify(o)),i(this).closest("tr").remove()}))},addFiles:function(n,o){var l=o.folders,c=void 0===l?[]:l,d=[],s=n.parents(".igd-acf-field");i(".empty-row",s).remove();var u=i('<tr><td><img class="file-icon" src=""/></td><td class="file-name" style="width: 300px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;display: block;"></td><td class="file-id"></td><td class="file-actions"><a href="" target="_blank" class="button file-view">View</a> <a href="" class="button file-download">Download</a> <a href="#" class="button button-link-delete file-remove" data-id="">Remove</a></td></tr>');c.forEach((function(n){var o="".concat(igd.ajaxUrl,"?action=igd_download&id=").concat(n.id,"&accountId=").concat(n.accountId);e(n)&&(o="".concat(igd.ajaxUrl,"?action=igd_download&file_ids=").concat(a(JSON.stringify([n.id])),"&request_id=").concat(n.id,"&accountId=").concat(n.accountId));var r="https://drive.google.com/file/d/".concat(n.id,"/preview?rm=minimal"),l=t(n,"full");d.push({id:n.id,account_id:n.accountId,name:n.name,type:n.type,size:n.size,embed_link:r,download_link:o,view_link:n.webViewLink,icon_link:n.iconLink,thumbnail_link:l});var c=u.clone();c.find(".file-icon").attr("src",n.iconLink),c.find(".file-name").text(n.name),c.find(".file-id").text(n.id),c.find(".file-view").attr("href",n.webViewLink),c.find(".file-download").attr("href",o),c.find(".file-remove").data("id",n.id),i("table",s).append(c)}));var f=i("input",s),m=f.val()?JSON.parse(f.val()):[];f.val(JSON.stringify([].concat(r(m),d)))}},i(document).ready(o.init)})();